---
layout: post
title:  "TCP 연결 끊기"
date:   2022-03-03 13:37:59 +0900
categories: Network
---

TCP에서 연결을 끊는 건 간단하다. <br>
TCP헤더에서 FIN비트를 1로 설정해서 보내면 된다. <br>
끝 <br>
<br>
<br>
<br>
이면 글을 안썻겠지.. <br>
<br>
FIN비트를 1로 설정해서 보내면 반대쪽에서 Ack 를 보낸다. <- 여기서 2번 <br>
그러고 반대쪽에서 보낼 데이터가 남아 있을수 있으니 따로 FIN비트를 1로 설정해서 보낸다. <br>
받은 쪽은 다시 Ack를 보낸다. <br>
이렇게 총 4번 통신을 하는걸 4웨이 핸드쉐이킹이라고 한다. <br>
<br>
연결을 종료 한 뒤 같은 포트의 소켓이 만들어진 상태에서 똑같은 곳으로 FIN이 도착할 경우 연결이 끊기는걸 막기 위해 TIME_WAIT으로 전환 된다. <br>
근데 서버에 TIME_WAIT 상태로 잡고있는 소켓이 많으면 새로 연결을 못한다고 배웠다. <br>
<br>
TCP에 SO_LINGER 옵션이랑.. NODELAY 같은것도 적어야 할거 같은데 다음 포스트에 좀더 자세히 공부해서 다뤄야겠다..<br>
지금 보는 책이 TCP 책이 아니라서 해당 옵션에 따른 차이점이 없다..<br>
<br>

